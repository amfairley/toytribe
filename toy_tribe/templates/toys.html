{% extends "base.html" %}

<!-- Title for browser tab -->
{% block title %}
> Toys
{% endblock %}

<!-- Toys Page Content -->
{% block content %}
    {% if 'user_id' in session %}
        <h2 class="playfair-display" id="toys-title">Toys</h2>
        <div class="fixed-action-btn add-toy-button">
            <p class="open-sans">Add Toy</p>
            <a class="btn-floating btn-large grey lighten-1" href="{{url_for('add_toy')}}" aria-label="Add a new toy">
                <i class="fa-solid fa-circle-plus"></i>
            </a>
        </div>
        <section class="row" id="toys-page">
            {% for toy in toys %}
            <div class="card sticky-action col s12 m6 l4 toys-card">
                <aside class="open-sans review-display right">
                    {% if toy.average_rating() | float != 0 %}
                    <!-- Star rating display from Fred Genkin https://codepen.io/FredGenkin/pens/showcase-->
                    <div class="Stars individual-toys-star-rating" style="--rating: {{ toy.average_rating() | float | round(1) }};" aria-label="Rating of this product is {{ toy.average_rating() | float | round(1) }} out of 5."></div>
                    {% else %}
                    <div class="no-reviews">Not reviewed yet</div>
                    {% endif %}
                </aside>
                <div class="card-image waves-effect waves-block waves-light center-align">
                    <a class="toy-image-link" href="{{ url_for('individual_toy', toy_id=toy.id) }}" aria-label="Go the individual toy page for {{ toy.name }}">
                        <img class="toys-image" src="{{ toy.image_url }}" alt="Image of {{ toy.name }}">
                    </a>
                </div>
                <div class="card-content">
                    <span class="card-title activator grey-text text-darken-4">
                        <a class="toys-toy-title open-sans" href="{{ url_for('individual_toy', toy_id=toy.id) }}">{{ toy.name }}</a>
                        <i class="fa-solid fa-ellipsis right" aria-label="See more information about {{ toy.name }}"></i>
                        <br>
                        <aside class="open-sans review-display">
                            {% if toy.average_rating() | float != 0 %}
                            <!-- Star rating display from Fred Genkin https://codepen.io/FredGenkin/pens/showcase-->
                            <div class="Stars individual-toys-star-rating" style="--rating: {{ toy.average_rating() | float | round(1) }};" aria-label="Rating of this product is {{ toy.average_rating() | float | round(1) }} out of 5."></div>
                            {% else %}
                            <p class="no-reviews">Not reviewed yet</p>
                            {% endif %}
                        </aside>
                    </span>
                    {% if user_id == toy.user_id %}
                        <div class="card-action">
                            <div class="toys-buttons-div">
                                <a href="{{ url_for('edit_toy', toy_id=toy.id) }}" class="waves-effect waves-light btn-small roboto-regular toys-buttons" aria-label="Go to edit toy page for {{ toy.name }}">Edit toy</a>
                                <a href="{{ url_for('delete_toy', toy_id=toy.id) }}" class="waves-effect waves-light btn-small roboto-regular toys-buttons" aria-label="Delete {{ toy.name }}">Delete toy</a>
                            </div>
                        </div>
                    {% endif %}
                </div>
                <div class="card-reveal">
                    <span class="card-title grey-text text-darken-4">
                        <a class="toys-toy-title open-sans" href="{{ url_for('individual_toy', toy_id=toy.id) }}" aria-label="Go the individual toy page for {{ toy.name }}">{{ toy.name }}</a>
                        <i class="fa-solid fa-x right"></i>
                    </span>
                    <p class="roboto-regular">
                        A {{ toy.company }} toy.
                        <br>
                        Type: {{ toy_types[toy.toy_type_id].toy_type }}
                    </p>
                    <p class="toy-description">
                        <strong>Description: </strong>{{ toy.description }}
                    </p>
                </div>
            </div>
            {% endfor %}
            <div class="back-to-top-container col s12 m6 l4 ">
                <a href="#" onclick="window.scrollTo({top: 0, behavior: 'smooth'}); return false;">
                    <i class="fa-solid fa-caret-up"></i><br>
                    <span>Back to top</span>
                </a>
            </div>
        </section>
    {% else %}
        <!-- Redirect to homepage -->
        <script>
            window.location.href = "{{ url_for('home') }}";
        </script>
    {% endif %}
{% endblock %}

<!-- <ul>
    <li class="toys-toy-id ">Toy ID: {{ toy.id }}</li>
    <li class="toys-user-id">User ID: {{ toy.user_id }}</li>
    <li class="toys-company-name">Company Name: {{ toy.company }}</li>
    <li class="toys-toy-type">Toy Type: {{ toy.type }}</li>
    <li class="toys-approved">Approved? {{ toy.is_approved }}</li>
    <li class="toys-image">Image URL: {{ toy.image_url }}</li>
    <li class="toys-created">Date created: {{ toy.date_of_creation }}</li>
</ul> -->